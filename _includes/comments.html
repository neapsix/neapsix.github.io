<div class="comments">

  <!-- get an array of comments that are for this page -->
  {% assign page_comments = site.comments | where:"page_id",page.id %}

  <!-- if there are comments for this page, add a heading -->
  {% case page_comments.size %}
    {% when 0 %}
    {% when 1 %}
      <h2 class="post-section-title">1 comment</h2>
    {% else %}
      <h2 class="post-section-title">{{page_comments.size}} comments</h2>
  {% endcase %}

  <!-- display the comments -->
  {% for c in page_comments %}
    <div class="comment">
      <p>
        <span class="comment-header">{{ c.name }}</br></span>
        <span class="comment-date">{{ c.date | date: "%b %-d, %Y %I:%M %p" }}</span>
      </p>
      <p>
        {{c.content | newline_to_br}}
      </p>
    </div>
  {% endfor %}

  <!-- comment form -->
  <h2 class="post-section-title">post a comment</h2>

  <!-- hidden __redirect, __subject and __replyto fields are used by formingo -->
  <form class="comment-form" method="POST" action="">
      <input type="hidden" name="__redirect" value="https://neapsix.github.io{{page.url}}" />
      <input type="hidden" name="__subject" value="New comment"/>
      <input type="hidden" name="page_id" value="{{page.id}}"/>
      <input type="hidden" name="date" value="{{site.time}}"/>
      <input type="text" name="spam" style="display: none;" autocomplete="off">
      <fieldset>
        <label for="name">Name: *</label><br>
        <input class="comment-field" type="text" name="name" id="name" required><br>
      </fieldset>
      <fieldset>
        <label for="__replyto">Email: *</label><br>
        <input type="email" name="__replyto" id="__replyto" required>
      </fieldset>
      <fieldset>
        <label for="comment">Comment:</label><br>
        <textarea name="comment" rows="8" cols="60" id="comment" required></textarea></br>
      </fieldset>
      <fieldset>
        <input type="submit" value="Submit">
      </fieldset>
      <fieldset>
        <legend>Comments are held for review. Email addresses are not published.</legend>
      </fieldset>
  </form>

</div>
